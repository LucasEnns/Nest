var app=function(){"use strict";function t(){}function e(t){return t()}function n(){return Object.create(null)}function i(t){t.forEach(e)}function s(t){return"function"==typeof t}function l(t,e){return t!=t?e==e:t!==e||t&&"object"==typeof t||"function"==typeof t}function r(e,n,i){e.$$.on_destroy.push(function(e,...n){if(null==e)return t;const i=e.subscribe(...n);return i.unsubscribe?()=>i.unsubscribe():i}(n,i))}function o(t){return null==t?"":t}function a(t,e,n=e){return t.set(n),e}function c(t,e){t.appendChild(e)}function u(t,e,n){t.insertBefore(e,n||null)}function h(t){t.parentNode.removeChild(t)}function d(t,e){for(let n=0;n<t.length;n+=1)t[n]&&t[n].d(e)}function f(t){return document.createElement(t)}function p(t){return document.createElementNS("http://www.w3.org/2000/svg",t)}function g(t){return document.createTextNode(t)}function m(){return g(" ")}function v(){return g("")}function w(t,e,n,i){return t.addEventListener(e,n,i),()=>t.removeEventListener(e,n,i)}function y(t,e,n){null==n?t.removeAttribute(e):t.getAttribute(e)!==n&&t.setAttribute(e,n)}function x(t){return""===t?void 0:+t}function $(t,e){e=""+e,t.wholeText!==e&&(t.data=e)}function b(t,e){t.value=null==e?"":e}let _;function k(t){_=t}function z(){if(!_)throw new Error("Function called outside component initialization");return _}const q=[],j=[],S=[],E=[],H=Promise.resolve();let R=!1;function A(t){S.push(t)}let M=!1;const C=new Set;function G(){if(!M){M=!0;do{for(let t=0;t<q.length;t+=1){const e=q[t];k(e),W(e.$$)}for(q.length=0;j.length;)j.pop()();for(let t=0;t<S.length;t+=1){const e=S[t];C.has(e)||(C.add(e),e())}S.length=0}while(q.length);for(;E.length;)E.pop()();R=!1,M=!1,C.clear()}}function W(t){if(null!==t.fragment){t.update(),i(t.before_update);const e=t.dirty;t.dirty=[-1],t.fragment&&t.fragment.p(t.ctx,e),t.after_update.forEach(A)}}const I=new Set;function N(t,e){t&&t.i&&(I.delete(t),t.i(e))}function O(t,e,n,i){if(t&&t.o){if(I.has(t))return;I.add(t),undefined.c.push((()=>{I.delete(t),i&&(n&&t.d(1),i())})),t.o(e)}}function T(t){t&&t.c()}function P(t,n,l){const{fragment:r,on_mount:o,on_destroy:a,after_update:c}=t.$$;r&&r.m(n,l),A((()=>{const n=o.map(e).filter(s);a?a.push(...n):i(n),t.$$.on_mount=[]})),c.forEach(A)}function L(t,e){const n=t.$$;null!==n.fragment&&(i(n.on_destroy),n.fragment&&n.fragment.d(e),n.on_destroy=n.fragment=null,n.ctx=[])}function U(t,e){-1===t.$$.dirty[0]&&(q.push(t),R||(R=!0,H.then(G)),t.$$.dirty.fill(0)),t.$$.dirty[e/31|0]|=1<<e%31}function F(e,s,l,r,o,a,c=[-1]){const u=_;k(e);const d=s.props||{},f=e.$$={fragment:null,ctx:null,props:a,update:t,not_equal:o,bound:n(),on_mount:[],on_destroy:[],before_update:[],after_update:[],context:new Map(u?u.$$.context:[]),callbacks:n(),dirty:c,skip_bound:!1};let p=!1;if(f.ctx=l?l(e,d,((t,n,...i)=>{const s=i.length?i[0]:n;return f.ctx&&o(f.ctx[t],f.ctx[t]=s)&&(!f.skip_bound&&f.bound[t]&&f.bound[t](s),p&&U(e,t)),n})):[],f.update(),p=!0,i(f.before_update),f.fragment=!!r&&r(f.ctx),s.target){if(s.hydrate){const t=function(t){return Array.from(t.childNodes)}(s.target);f.fragment&&f.fragment.l(t),t.forEach(h)}else f.fragment&&f.fragment.c();s.intro&&N(e.$$.fragment),P(e,s.target,s.anchor),G()}k(u)}class B{$destroy(){L(this,1),this.$destroy=t}$on(t,e){const n=this.$$.callbacks[t]||(this.$$.callbacks[t]=[]);return n.push(e),()=>{const t=n.indexOf(e);-1!==t&&n.splice(t,1)}}$set(t){var e;this.$$set&&(e=t,0!==Object.keys(e).length)&&(this.$$.skip_bound=!0,this.$$set(t),this.$$.skip_bound=!1)}}let D=.375,Y=0,X=[],Z={width:49,height:97,margins:.25,max_width:()=>Z.width-2*Z.margins-D,max_height:()=>Z.height-2*Z.margins-D};function J(t,e=1,n=!1,i=D,s=Y,l=Z){X=[];const r=new et(t.slice(e).flatMap((t=>function([t,e,n,i]){if(n>Z.max_width()||i>Z.max_height())return X.push(`Panel ${t} is too big`),[];if(!n||!i||!e)return[];let s=1,l=[];for(;e>=s;){let r="";e>1&&(r=` ... ${s} of ${e}`),l.push([t+r,t,parseFloat(n),parseFloat(i)]),s++}return l}(t).map((t=>new Q(t)))))).flat();function o(t){let e=new et(t.widest().place()),n=e[0].width;for(;t.fitsColumn(e);){let i=new et(t.fitsColumn(e).place());for(;t.fitsRow(i,n);)i.push(t.fitsRow(i,n).place());1===i.length?e.push(i[0]):e.push(i)}return e.ascendingWidth()}function a(t){let e=new et(t.widest().place());for(;t.fitsSheet(e);)e.push(t.fitsSheet(e).place());return e}function c(t,e){let n=Z.margins,i=Z.margins,s=new et;t.forEach(((e,l)=>{0===l?s.push(n):s.push(s.last()+t[l-1].width);let r=new et;e.group.forEach(((t,e,n)=>{0===e?r.push(i):n[e-1]instanceof et?r.push(r.last()+n[e-1].filledHeight()):r.push(r.last()+n[e-1].height),t instanceof Q?(t.x0=s[l],t.y0=r[e]):t.forEach(((n,i)=>{n.x0=0===i?s[l]:t[i-1].x0+t[i-1].width,n.y0=r[e]}))}))}))}return D=i,Y=s,Z.width=l.width,Z.height=l.height,Z.margins=l.margins,[r,function(t){let e=function(t){let e=new et;for(;t.notPlaced().length>0;){let n=o(t);e.push(new V(n.columnWidth(),n.columnHeight(),n.columnArea(),n))}return e}(t),n=new et;for(;e.notPlaced().length>0;){let t=a(e);c(t),n.push(new tt(t.filledWidth(),t.filledHeight(),t.filledArea(),t.map((t=>t.group)).flatten(2),t,n.length+1))}return n}(r),X]}class K{constructor(){this.placed=!1}place(){return this.placed=!0,this}}class Q extends K{constructor([t,e,n,i]){super(),this.uniqueID=t,this.id=e,this.width=n+D+Y,this.height=i+D+Y,this.area=this.height*this.width,this.x0=0,this.y0=0}}class V extends K{constructor(t,e,n,i){super(),this.width=t,this.height=e,this.area=n,this.group=i}}class tt extends V{constructor(t,e,n,i,s,l){super(t,e,n,i),this.columns=s,this.sheet_width=Z.width,this.sheet_height=Z.height,this.sheet_area=Z.width*Z.height,this.waste_area=this.sheet_area-this.area,this.waste_ratio=1-this.area/this.sheet_area,this.id="Sheet "+l,delete this.placed}}class et extends Array{first(){return this[0]}last(){return this[this.length-1]}flatten(t=1){let e=this;for(;t--;)e=e.flat();return e}shuffle(){return this.length<3?this:new et(...this.slice(1),this.first())}ascendingWidth(){return new et(...this).sort(((t,e)=>e.width!=t.width?e.width-t.width:e.height-t.height))}ascendingHeight(){return new et(...this).sort(((t,e)=>e.height!=t.height?e.height-t.height:e.width-t.width))}notPlaced(){return this.filter((t=>!t.placed))}widest(){return this.notPlaced().ascendingWidth().first()}narrowest(){return this.notPlaced().ascendingWidth().last()}tallest(){return this.notPlaced().ascendingHeight().first()}shortest(){return this.notPlaced().ascendingHeight().last()}biggest(){return this.sort(((t,e)=>e.area-t.area)).notPlaced().first()}totalWidth(){return this.reduce(((t,e)=>e instanceof et?t+e.ascendingWidth().first().width:t+e.width),0)}totalHeight(){return this.reduce(((t,e)=>e instanceof et?t+e.ascendingHeight().first().height:t+e.height),0)}totalArea(){return this.reduce(((t,e)=>t+e.area),0)}columnWidth(){return this.flat().ascendingWidth().first().width}columnHeight(){return this.totalHeight()}columnArea(){return this.flat().totalArea()}filledHeight(){return this.ascendingHeight().first().height}filledWidth(){return this.totalWidth()}filledArea(){return this.flat().totalArea()}remainingWidth(t){return t-this.totalWidth()}remainingHeight(t){return t-this.totalHeight()}fitsColumn(t,e=Z.height){return this.notPlaced().filter((e=>e.width<=t[0].width)).filter((n=>n.height<t.remainingHeight(e))).widest()}fitsRow(t,e){return this.notPlaced().filter((e=>e.height<=t[0].height)).filter((n=>n.width<t.remainingWidth(e))).widest()}fitsSheet(t,e=Z.width){return this.notPlaced().filter((n=>n.width<t.remainingWidth(e))).widest()}}function nt(t){const e=t=>parseFloat(parseFloat(t).toFixed(4));return isNaN(t)?t.includes("/")&&!t.includes(".")?t.split(" ").filter((t=>""!==t)).reduce(((t,n)=>{if(n.includes("/")){let i=n.split("/").filter((t=>""!==t));return t+e(i[0]/i[1])}return t+e(n)}),0):t:e(t)}function it(t,e){return parseInt(t*10**e)/10**e}function st(t,e){const n={mm:t.getMonth()+1,dd:t.getDate(),yy:t.getFullYear().toString().slice(-2),yyyy:t.getFullYear(),H:t.getHours(),M:t.getMinutes(),S:t.getSeconds()};return e.replace(/mm|dd|yy|yyyy|H|M|S/gi,(t=>n[t]))}let lt=30,rt=120,ot=1;function at(t,e,n){return[`( ${n} )`,`( ${st(new Date,"yyyy/mm/dd H:M")} )`,"G40 G80 G91 G28 Z0","G70","M6 T"+t,`S${e} M3`,"G54 G90","G43 H"+t]}function ct(t,e,n){return`G00 X${gt(t)} Y${gt(e)} Z${gt(n)}`}function ut(t){return"G00 Z"+gt(t)}function ht(t,e,n,i){return`G01 X${gt(t)} Y${gt(e)} Z${gt(n)} F${i}`}function dt(t,e,n,i){return`G01 X${gt(t)} Y${gt(e)} Z${gt(n)} F${i}`}function ft(t){return"X"+gt(t)}function pt(t){return"Y"+gt(t)}function gt(t){return/\./.test(t)||0===t?t:t.toFixed(1)}function mt(t,e,n){ot=e.thickness+.5,lt=e.width/2,rt=e.height+10;let i=[...at(9,18e3,n)];return t.forEach((t=>{var e;i.push(`( ${t.id} )`),t.columns.forEach(((t,e)=>{t.group.flat().sort(((t,n)=>e%2!=0?t.y0!=n.y0:n.y0!=t.y0?n.y0-t.y0:n.x0-t.x0)).forEach((t=>i.push(function(t){const{x0:e,y0:n,width:i,height:s}=t;let l=e+i,r=n+s,o=n+s/5,a=o+ot;return[`( cutting panel ${t.uniqueID} )`,ct(e,o,ot),ht(e,a,0,50),dt(e,r,0,400),ft(l),pt(n),ft(e),pt(a),ut(ot)]}(t))))})),i.push((e=rt,["M05",`G90 X${gt(lt)} Y${gt(e)}`,"M00","( Add new sheet and press cycle start :)"]))})),i.pop(),i.push(["G40 G80 G91 G28 Z0 M5",`G00 G90 X${gt(lt)} Y${gt(rt)}`,"M30"]),i.flat().join("\n")}const vt=[];function wt(e,n=t){let i;const s=[];function r(t){if(l(e,t)&&(e=t,i)){const t=!vt.length;for(let t=0;t<s.length;t+=1){const n=s[t];n[1](),vt.push(n,e)}if(t){for(let t=0;t<vt.length;t+=2)vt[t][0](vt[t+1]);vt.length=0}}}return{set:r,update:function(t){r(t(e))},subscribe:function(l,o=t){const a=[l,o];return s.push(a),1===s.length&&(i=n(r)||t),l(e),()=>{const t=s.indexOf(a);-1!==t&&s.splice(t,1),0===s.length&&(i(),i=null)}}}}const yt=(t,e)=>{const n=t=>JSON.stringify(t,null,2),i=JSON.parse;null===sessionStorage.getItem(t)&&sessionStorage.setItem(t,n(e));const s=i(sessionStorage.getItem(t)),{subscribe:l,set:r,update:o}=wt(s);return{subscribe:l,set:e=>(sessionStorage.setItem(t,n(e)),r(e)),update:o}};const xt={name:st(new Date,"yymmdd-HM"),errors:[],contents:[["Project name:","New"],["Border (+ or -)",0],["Metric units",!1],[,,,],["Panel","Q","W","H"],[1,,,]]},$t=((t,e)=>{const n=t=>JSON.stringify(t,null,2),i=JSON.parse;null===localStorage.getItem(t)&&localStorage.setItem(t,n(e));const s=i(localStorage.getItem(t)),{subscribe:l,set:r,update:o}=wt(s);return{subscribe:l,set:e=>(localStorage.setItem(t,n(e)),r(e)),update:o}})("settings",{material:{width:49,height:97,thickness:.75,margins:.125},cutter:.375,gap:0,units:!1}),bt=yt("panels",[]),_t=yt("sheets",[]),kt=yt("csv-file",xt),zt=yt("svg",""),qt=yt("activePanel","");var jt="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};var St,Et;(function(t,e){!function(){function e(t,e){return void 0===e?e={autoBom:!1}:"object"!=typeof e&&(console.warn("Deprecated: Expected third argument to be a object"),e={autoBom:!e}),e.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(t.type)?new Blob(["\ufeff",t],{type:t.type}):t}function n(t,e,n){var i=new XMLHttpRequest;i.open("GET",t),i.responseType="blob",i.onload=function(){o(i.response,e,n)},i.onerror=function(){console.error("could not download file")},i.send()}function i(t){var e=new XMLHttpRequest;e.open("HEAD",t,!1);try{e.send()}catch(t){}return 200<=e.status&&299>=e.status}function s(t){try{t.dispatchEvent(new MouseEvent("click"))}catch(n){var e=document.createEvent("MouseEvents");e.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),t.dispatchEvent(e)}}var l="object"==typeof window&&window.window===window?window:"object"==typeof self&&self.self===self?self:"object"==typeof jt&&jt.global===jt?jt:void 0,r=l.navigator&&/Macintosh/.test(navigator.userAgent)&&/AppleWebKit/.test(navigator.userAgent)&&!/Safari/.test(navigator.userAgent),o=l.saveAs||("object"!=typeof window||window!==l?function(){}:"download"in HTMLAnchorElement.prototype&&!r?function(t,e,r){var o=l.URL||l.webkitURL,a=document.createElement("a");e=e||t.name||"download",a.download=e,a.rel="noopener","string"==typeof t?(a.href=t,a.origin===location.origin?s(a):i(a.href)?n(t,e,r):s(a,a.target="_blank")):(a.href=o.createObjectURL(t),setTimeout((function(){o.revokeObjectURL(a.href)}),4e4),setTimeout((function(){s(a)}),0))}:"msSaveOrOpenBlob"in navigator?function(t,l,r){if(l=l||t.name||"download","string"!=typeof t)navigator.msSaveOrOpenBlob(e(t,r),l);else if(i(t))n(t,l,r);else{var o=document.createElement("a");o.href=t,o.target="_blank",setTimeout((function(){s(o)}))}}:function(t,e,i,s){if((s=s||open("","_blank"))&&(s.document.title=s.document.body.innerText="downloading..."),"string"==typeof t)return n(t,e,i);var o="application/octet-stream"===t.type,a=/constructor/i.test(l.HTMLElement)||l.safari,c=/CriOS\/[\d]+/.test(navigator.userAgent);if((c||o&&a||r)&&"undefined"!=typeof FileReader){var u=new FileReader;u.onloadend=function(){var t=u.result;t=c?t:t.replace(/^data:[^;]*;/,"data:attachment/file;"),s?s.location.href=t:location=t,s=null},u.readAsDataURL(t)}else{var h=l.URL||l.webkitURL,d=h.createObjectURL(t);s?s.location=d:location.href=d,s=null,setTimeout((function(){h.revokeObjectURL(d)}),4e4)}});l.saveAs=o.saveAs=o,t.exports=o}()})(Et={path:St,exports:{},require:function(t,e){return function(){throw new Error("Dynamic requires are not currently supported by @rollup/plugin-commonjs")}(null==e&&Et.path)}},Et.exports),Et.exports;function Ht(e){let n,i,s,l,r;return{c(){n=f("div"),i=m(),s=f("div"),l=m(),r=f("div"),y(n,"class","file-icon dl-csv-block blocked svelte-1qzoat3"),y(s,"class","file-icon dl-svg-block blocked svelte-1qzoat3"),y(r,"class","file-icon dl-cnc-block blocked svelte-1qzoat3")},m(t,e){u(t,n,e),u(t,i,e),u(t,s,e),u(t,l,e),u(t,r,e)},p:t,d(t){t&&h(n),t&&h(i),t&&h(s),t&&h(l),t&&h(r)}}}function Rt(t){let e,n,i,s,l,r,o,a,d,p,g,v,w,x;return{c(){e=f("a"),n=f("div"),l=m(),r=f("a"),o=f("div"),p=m(),g=f("a"),v=f("div"),y(n,"class","file-icon dl-csv svelte-1qzoat3"),y(e,"href",i="data:text/plain;charset=utf-8,"+encodeURIComponent(t[7])),y(e,"download",s=t[2].name+t[8]+".csv"),y(e,"alt","download csv file"),y(e,"class","svelte-1qzoat3"),y(o,"class","file-icon dl-svg svelte-1qzoat3"),y(r,"href",a="data:text/plain;charset=utf-8,"+encodeURIComponent(t[6])),y(r,"download",d=t[2].name+t[8]+".svg"),y(r,"alt","download svg file"),y(r,"class","svelte-1qzoat3"),y(v,"class","file-icon dl-cnc svelte-1qzoat3"),y(g,"href",w="data:text/plain;charset=utf-8,"+encodeURIComponent(t[3]())),y(g,"download",x=t[2].name+t[8]+".cnc"),y(g,"alt","download g-code file"),y(g,"class","svelte-1qzoat3")},m(t,i){u(t,e,i),c(e,n),u(t,l,i),u(t,r,i),c(r,o),u(t,p,i),u(t,g,i),c(g,v)},p(t,n){4&n&&s!==(s=t[2].name+t[8]+".csv")&&y(e,"download",s),64&n&&a!==(a="data:text/plain;charset=utf-8,"+encodeURIComponent(t[6]))&&y(r,"href",a),4&n&&d!==(d=t[2].name+t[8]+".svg")&&y(r,"download",d),8&n&&w!==(w="data:text/plain;charset=utf-8,"+encodeURIComponent(t[3]()))&&y(g,"href",w),4&n&&x!==(x=t[2].name+t[8]+".cnc")&&y(g,"download",x)},d(t){t&&h(e),t&&h(l),t&&h(r),t&&h(p),t&&h(g)}}}function At(e){let n,s,l,r,o,a,d,p,g,v,$,_,k,z,q,j,S,E,H,R,A,M,C,G,W,I,N,O,T,P,L,U,F,B,D,Y,X,Z,J,K,Q,V,tt,et;function nt(t,e){return t[4].length?Rt:Ht}document.title=n=e[2].name||"Nest";let it=nt(e),st=it(e);return{c(){s=m(),l=f("div"),r=f("div"),o=m(),a=f("input"),d=m(),p=f("label"),g=f("div"),$=m(),st.c(),_=m(),k=f("div"),z=f("div"),q=f("h5"),q.textContent="Material W x H x T",j=m(),S=f("input"),E=m(),H=f("span"),H.textContent="x",R=m(),A=f("input"),M=m(),C=f("span"),C.textContent="x",G=m(),W=f("input"),I=m(),N=f("div"),O=f("h5"),O.textContent="Margins",T=m(),P=f("input"),L=m(),U=f("div"),F=f("h5"),F.textContent="Tool Kerf",B=m(),D=f("input"),Y=m(),X=f("div"),Z=f("h5"),Z.textContent="Units",J=m(),K=f("label"),Q=f("input"),V=f("div"),y(r,"class","file-icon new svelte-1qzoat3"),y(r,"alt","new csv file"),y(a,"class","inputfile svelte-1qzoat3"),y(a,"name","file"),y(a,"id","file"),y(a,"type","file"),y(g,"class",v="file-icon "+(e[0]?"badfile":"upload")+" svelte-1qzoat3"),y(p,"for","file"),y(p,"alt","upload a csv file"),y(p,"class","svelte-1qzoat3"),y(l,"class","file-mgmt svelte-1qzoat3"),y(q,"class","svelte-1qzoat3"),y(S,"class","input svelte-1qzoat3"),y(S,"type","number"),y(S,"step","0.0625"),y(H,"class","svelte-1qzoat3"),y(A,"class","input svelte-1qzoat3"),y(A,"type","number"),y(A,"step","0.0625"),y(C,"class","svelte-1qzoat3"),y(W,"class","input svelte-1qzoat3"),y(W,"type","number"),y(W,"step","0.005"),y(z,"class","input-wrapper svelte-1qzoat3"),y(O,"class","svelte-1qzoat3"),y(P,"class","input svelte-1qzoat3"),y(P,"type","number"),y(P,"step","0.03125"),y(N,"class","input-wrapper svelte-1qzoat3"),y(F,"class","svelte-1qzoat3"),y(D,"class","input svelte-1qzoat3"),y(D,"type","number"),y(D,"step","0.03125"),y(U,"class","input-wrapper svelte-1qzoat3"),y(Z,"class","svelte-1qzoat3"),y(Q,"type","checkbox"),y(Q,"class","svelte-1qzoat3"),y(V,"class","slider svelte-1qzoat3"),y(K,"class","switch svelte-1qzoat3"),y(X,"class","input-wrapper svelte-1qzoat3"),y(k,"class","settings svelte-1qzoat3")},m(t,n){u(t,s,n),u(t,l,n),c(l,r),c(l,o),c(l,a),e[12](a),c(l,d),c(l,p),c(p,g),c(l,$),st.m(l,null),u(t,_,n),u(t,k,n),c(k,z),c(z,q),c(z,j),c(z,S),b(S,e[5].material.width),c(z,E),c(z,H),c(z,R),c(z,A),b(A,e[5].material.height),c(z,M),c(z,C),c(z,G),c(z,W),b(W,e[5].material.thickness),c(k,I),c(k,N),c(N,O),c(N,T),c(N,P),b(P,e[5].material.margins),c(k,L),c(k,U),c(U,F),c(U,B),c(U,D),b(D,e[5].cutter),c(k,Y),c(k,X),c(X,Z),c(X,J),c(X,K),c(K,Q),Q.checked=e[5].units,c(K,V),tt||(et=[w(r,"click",e[10]),w(a,"change",e[11]),w(g,"mouseover",e[13]),w(S,"change",e[9]),w(S,"input",e[14]),w(A,"change",e[9]),w(A,"input",e[15]),w(W,"change",e[9]),w(W,"input",e[16]),w(P,"change",e[9]),w(P,"input",e[17]),w(D,"change",e[9]),w(D,"input",e[18]),w(Q,"change",e[19])],tt=!0)},p(t,[e]){4&e&&n!==(n=t[2].name||"Nest")&&(document.title=n),1&e&&v!==(v="file-icon "+(t[0]?"badfile":"upload")+" svelte-1qzoat3")&&y(g,"class",v),it===(it=nt(t))&&st?st.p(t,e):(st.d(1),st=it(t),st&&(st.c(),st.m(l,null))),32&e&&x(S.value)!==t[5].material.width&&b(S,t[5].material.width),32&e&&x(A.value)!==t[5].material.height&&b(A,t[5].material.height),32&e&&x(W.value)!==t[5].material.thickness&&b(W,t[5].material.thickness),32&e&&x(P.value)!==t[5].material.margins&&b(P,t[5].material.margins),32&e&&x(D.value)!==t[5].cutter&&b(D,t[5].cutter),32&e&&(Q.checked=t[5].units)},i:t,o:t,d(t){t&&h(s),t&&h(l),e[12](null),st.d(),t&&h(_),t&&h(k),tt=!1,i(et)}}}function Mt(t,e,n){let i,s,l,o,c;r(t,kt,(t=>n(2,i=t))),r(t,_t,(t=>n(4,s=t))),r(t,$t,(t=>n(5,l=t))),r(t,bt,(t=>n(20,o=t))),r(t,zt,(t=>n(6,c=t)));let u,h=!1,d=i.contents.join("\n");!function(t){z().$$.before_update.push(t)}((()=>{i.contents>5&&p()}));const f=st(new Date,"_yymmdd");function p(){let t=J(i.contents,5,l.units,l.cutter,l.gap,l.material);a(bt,o=t[0]),a(_t,s=t[1]),a(kt,i.errors=t[2],i)}let g;return t.$$.update=()=>{52&t.$$.dirty&&n(3,g=()=>mt(s,l.material,i.name))},[h,u,i,g,s,l,c,d,f,p,function(){a(kt,i=xt)},function(){if(u.files[0].name.includes(".csv")){a(kt,i.name=u.files[0].name.replace(".csv",""),i);let t=new FileReader;t.readAsText(u.files[0]),t.onload=function(t){a(kt,i.contents=function(t,e=1,n=","){for(var i=new RegExp("(\\"+n+'|\\r?\\n|\\r|^)(?:"([^"]*(?:""[^"]*)*)"|([^"\\'+n+"\\r\\n]*))","gi"),s=[[]],l=null;l=i.exec(t);){var r=l[1];if(r.length&&r!=n&&s.push([]),l[2])var o=l[2].replace(new RegExp('""',"g"),'"');else o=l[3];/\d/.test(o)&&(o=nt(o)),s[s.length-1].push(o)}return s.filter(((t,n)=>n<e||t.filter((t=>""!==t)).length))}(t.target.result,5),i),p(),n(0,h=!1)}}else n(0,h=!0)},function(t){j[t?"unshift":"push"]((()=>{u=t,n(1,u)}))},()=>n(0,h=!1),function(){l.material.width=x(this.value),$t.set(l)},function(){l.material.height=x(this.value),$t.set(l)},function(){l.material.thickness=x(this.value),$t.set(l)},function(){l.material.margins=x(this.value),$t.set(l)},function(){l.cutter=x(this.value),$t.set(l)},function(){l.units=this.checked,$t.set(l)}]}class Ct extends B{constructor(t){super(),F(this,t,Mt,At,l,{})}}function Gt(t,e,n){const i=t.slice();return i[22]=e[n],i}function Wt(t,e,n){const i=t.slice();return i[19]=e[n],i[21]=n,i}function It(t){let e,n,s,l,r,o,a,d,f,m,v,x,b,_,k=t[22].id+"";return{c(){e=p("rect"),d=p("text"),f=g(k),y(e,"class",n="panel "+(t[4]==t[22].id?"active":"")+" print svelte-6pznax"),y(e,"id",s=t[22].id),y(e,"x",l=(t[22].x0+t[21]*t[19].sheet_width)*t[5]),y(e,"y",r=t[22].y0*t[5]),y(e,"width",o=t[22].width*t[5]),y(e,"height",a=t[22].height*t[5]),y(d,"class",m="idh "+(t[4]==t[22].id?"active":"")+" print svelte-6pznax"),y(d,"x",v=(t[22].x0+t[22].width/2+t[21]*t[19].sheet_width)*t[5]),y(d,"y",x=(t[22].y0+1+t[22].height/2)*t[5])},m(n,i){u(n,e,i),u(n,d,i),c(d,f),b||(_=[w(e,"mouseover",t[6]),w(e,"mouseleave",t[7])],b=!0)},p(t,i){20&i&&n!==(n="panel "+(t[4]==t[22].id?"active":"")+" print svelte-6pznax")&&y(e,"class",n),4&i&&s!==(s=t[22].id)&&y(e,"id",s),4&i&&l!==(l=(t[22].x0+t[21]*t[19].sheet_width)*t[5])&&y(e,"x",l),4&i&&r!==(r=t[22].y0*t[5])&&y(e,"y",r),4&i&&o!==(o=t[22].width*t[5])&&y(e,"width",o),4&i&&a!==(a=t[22].height*t[5])&&y(e,"height",a),4&i&&k!==(k=t[22].id+"")&&$(f,k),20&i&&m!==(m="idh "+(t[4]==t[22].id?"active":"")+" print svelte-6pznax")&&y(d,"class",m),4&i&&v!==(v=(t[22].x0+t[22].width/2+t[21]*t[19].sheet_width)*t[5])&&y(d,"x",v),4&i&&x!==(x=(t[22].y0+1+t[22].height/2)*t[5])&&y(d,"y",x)},d(t){t&&h(e),t&&h(d),b=!1,i(_)}}}function Nt(t){let e,n,i,s,l,r,o,a=t[19].group,f=[];for(let e=0;e<a.length;e+=1)f[e]=It(Gt(t,a,e));return{c(){e=p("g"),n=p("rect"),o=p("g");for(let t=0;t<f.length;t+=1)f[t].c();y(n,"class","sheet print svelte-6pznax"),y(n,"id",i=t[19].id),y(n,"x",s=t[21]*t[19].sheet_width*t[5]),y(n,"y","0"),y(n,"width",l=t[19].sheet_width*t[5]),y(n,"height",r=t[19].sheet_height*t[5]),y(e,"id","sheets"),y(e,"class","svelte-6pznax"),y(o,"id","panels"),y(o,"class","svelte-6pznax")},m(t,i){u(t,e,i),c(e,n),u(t,o,i);for(let t=0;t<f.length;t+=1)f[t].m(o,null)},p(t,e){if(4&e&&i!==(i=t[19].id)&&y(n,"id",i),4&e&&s!==(s=t[21]*t[19].sheet_width*t[5])&&y(n,"x",s),4&e&&l!==(l=t[19].sheet_width*t[5])&&y(n,"width",l),4&e&&r!==(r=t[19].sheet_height*t[5])&&y(n,"height",r),244&e){let n;for(a=t[19].group,n=0;n<a.length;n+=1){const i=Gt(t,a,n);f[n]?f[n].p(i,e):(f[n]=It(i),f[n].c(),f[n].m(o,null))}for(;n<f.length;n+=1)f[n].d(1);f.length=a.length}},d(t){t&&h(e),t&&h(o),d(f,t)}}}function Ot(e){let n,i,s,l,r,o=e[2],a=[];for(let t=0;t<o.length;t+=1)a[t]=Nt(Wt(e,o,t));return{c(){n=f("div"),i=p("svg");for(let t=0;t<a.length;t+=1)a[t].c();y(i,"class","print svelte-6pznax"),y(i,"version","1.1"),y(i,"xmlns","http://www.w3.org/2000/svg"),y(i,"xmlns:xlink","http://www.w3.org/1999/xlink"),y(i,"width",s=e[1]*e[5]),y(i,"height",l=e[3]*e[5]),y(i,"viewBox",r="0 0 "+e[1]*e[5]+" "+e[3]*e[5]),y(i,"preserveAspectRatio","xMidYMid meet"),y(n,"class","viewer svelte-6pznax")},m(t,s){u(t,n,s),c(n,i);for(let t=0;t<a.length;t+=1)a[t].m(i,null);e[8](n)},p(t,[e]){if(244&e){let n;for(o=t[2],n=0;n<o.length;n+=1){const s=Wt(t,o,n);a[n]?a[n].p(s,e):(a[n]=Nt(s),a[n].c(),a[n].m(i,null))}for(;n<a.length;n+=1)a[n].d(1);a.length=o.length}2&e&&s!==(s=t[1]*t[5])&&y(i,"width",s),8&e&&l!==(l=t[3]*t[5])&&y(i,"height",l),10&e&&r!==(r="0 0 "+t[1]*t[5]+" "+t[3]*t[5])&&y(i,"viewBox",r)},i:t,o:t,d(t){t&&h(n),d(a,t),e[8](null)}}}function Tt(t,e,n){let i,s,l,o;r(t,_t,(t=>n(2,i=t))),r(t,$t,(t=>n(15,s=t))),r(t,zt,(t=>n(16,l=t))),r(t,qt,(t=>n(4,o=t)));let c,u,h,d,f,p,g=0,m=0;return function(t){z().$$.after_update.push(t)}((()=>{i.length&&a(zt,l=d.innerHTML.toString())})),t.$$.update=()=>{32772&t.$$.dirty&&n(1,f=i.length*s.material.width),32768&t.$$.dirty&&n(3,p=s.material.height)},[d,f,i,p,o,90,function(){a(qt,o=this.id);let t=this.getBoundingClientRect();g=t.bottom+12,m=t.left+12,c=this.id,u=this.width.baseVal.valueAsString,h=this.height.baseVal.valueAsString},function(t){a(qt,o="")},function(t){j[t?"unshift":"push"]((()=>{d=t,n(0,d)}))}]}class Pt extends B{constructor(t){super(),F(this,t,Tt,Ot,l,{})}}function Lt(t,e,n){const i=t.slice();return i[20]=e[n],i[21]=e,i[22]=n,i}function Ut(t,e,n){const i=t.slice();return i[23]=e[n],i}function Ft(t){let e,n,s,l,r,o,a,p,x,b,_,k,z,q,j,S,E=t[1].contents[0][1]+"",H=t[1].errors.length&&Bt(t),R=t[0],A=[];for(let e=0;e<R.length;e+=1)A[e]=Yt(Lt(t,R,e));return{c(){H&&H.c(),e=m(),n=f("h1"),s=g(E),l=m(),r=f("ul"),o=f("li"),o.textContent="Panel",a=m(),p=f("li"),p.textContent="Q",x=m(),b=f("li"),b.textContent="W",_=m(),k=f("li"),k.textContent="H",z=m();for(let t=0;t<A.length;t+=1)A[t].c();q=v(),y(n,"class","svelte-j5ao4g"),y(o,"class","svelte-j5ao4g"),y(p,"class","svelte-j5ao4g"),y(b,"class","svelte-j5ao4g"),y(k,"class","svelte-j5ao4g"),y(r,"class","svelte-j5ao4g")},m(i,h){H&&H.m(i,h),u(i,e,h),u(i,n,h),c(n,s),u(i,l,h),u(i,r,h),c(r,o),c(r,a),c(r,p),c(r,x),c(r,b),c(r,_),c(r,k),u(i,z,h);for(let t=0;t<A.length;t+=1)A[t].m(i,h);u(i,q,h),j||(S=[w(o,"click",t[7]),w(p,"click",t[8]),w(b,"click",t[9]),w(k,"click",t[10])],j=!0)},p(t,n){if(t[1].errors.length?H?H.p(t,n):(H=Bt(t),H.c(),H.m(e.parentNode,e)):H&&(H.d(1),H=null),2&n&&E!==(E=t[1].contents[0][1]+"")&&$(s,E),13&n){let e;for(R=t[0],e=0;e<R.length;e+=1){const i=Lt(t,R,e);A[e]?A[e].p(i,n):(A[e]=Yt(i),A[e].c(),A[e].m(q.parentNode,q))}for(;e<A.length;e+=1)A[e].d(1);A.length=R.length}},d(t){H&&H.d(t),t&&h(e),t&&h(n),t&&h(l),t&&h(r),t&&h(z),d(A,t),t&&h(q),j=!1,i(S)}}}function Bt(t){let e,n,i,s,l,r,o=t[1].errors.length>1?"S":"",a=t[1].errors,p=[];for(let e=0;e<a.length;e+=1)p[e]=Dt(Ut(t,a,e));return{c(){e=f("h5"),n=g("ERROR"),i=g(o),s=g(":"),l=m();for(let t=0;t<p.length;t+=1)p[t].c();r=v()},m(t,o){u(t,e,o),c(e,n),c(e,i),c(e,s),u(t,l,o);for(let e=0;e<p.length;e+=1)p[e].m(t,o);u(t,r,o)},p(t,e){if(2&e&&o!==(o=t[1].errors.length>1?"S":"")&&$(i,o),2&e){let n;for(a=t[1].errors,n=0;n<a.length;n+=1){const i=Ut(t,a,n);p[n]?p[n].p(i,e):(p[n]=Dt(i),p[n].c(),p[n].m(r.parentNode,r))}for(;n<p.length;n+=1)p[n].d(1);p.length=a.length}},d(t){t&&h(e),t&&h(l),d(p,t),t&&h(r)}}}function Dt(t){let e,n,i=t[23]+"";return{c(){e=f("p"),n=g(i)},m(t,i){u(t,e,i),c(e,n)},p(t,e){2&e&&i!==(i=t[23]+"")&&$(n,i)},d(t){t&&h(e)}}}function Yt(t){let e,n,s,l,r,a,d,p,g,v,$,_,k,z,q,j;function S(){t[11].call(s,t[21],t[22])}function E(){t[12].call(a,t[21],t[22])}function H(){t[13].call(g,t[21],t[22])}function R(){t[14].call(_,t[21],t[22])}function A(...e){return t[15](t[20],...e)}return{c(){e=f("ul"),n=f("li"),s=f("input"),l=m(),r=f("li"),a=f("input"),d=m(),p=f("li"),g=f("input"),v=m(),$=f("li"),_=f("input"),k=m(),y(s,"type","text"),y(s,"class","svelte-j5ao4g"),y(n,"class","svelte-j5ao4g"),y(a,"type","number"),y(a,"class","svelte-j5ao4g"),y(r,"class","svelte-j5ao4g"),y(g,"type","number"),y(g,"step","0.03125"),y(g,"class","svelte-j5ao4g"),y(p,"class","svelte-j5ao4g"),y(_,"type","number"),y(_,"step","0.03125"),y(_,"class","svelte-j5ao4g"),y($,"class","svelte-j5ao4g"),y(e,"class",z=o(t[2]==t[20][0]?"active":"")+" svelte-j5ao4g")},m(i,o){u(i,e,o),c(e,n),c(n,s),b(s,t[20][0]),c(e,l),c(e,r),c(r,a),b(a,t[20][1]),c(e,d),c(e,p),c(p,g),b(g,t[20][2]),c(e,v),c(e,$),c($,_),b(_,t[20][3]),c(e,k),q||(j=[w(s,"input",S),w(s,"focus",Zt),w(s,"keyup",t[3]),w(a,"input",E),w(a,"focus",Zt),w(a,"keyup",t[3]),w(g,"input",H),w(g,"focus",Zt),w(g,"keyup",t[3]),w(_,"input",R),w(_,"focus",Zt),w(_,"keyup",t[3]),w(e,"mouseenter",A),w(e,"mouseleave",t[16])],q=!0)},p(n,i){t=n,1&i&&s.value!==t[20][0]&&b(s,t[20][0]),1&i&&x(a.value)!==t[20][1]&&b(a,t[20][1]),1&i&&x(g.value)!==t[20][2]&&b(g,t[20][2]),1&i&&x(_.value)!==t[20][3]&&b(_,t[20][3]),5&i&&z!==(z=o(t[2]==t[20][0]?"active":"")+" svelte-j5ao4g")&&y(e,"class",z)},d(t){t&&h(e),q=!1,i(j)}}}function Xt(e){let n,i,s,l,r,o,a=e[1].name&&Ft(e);return{c(){n=f("div"),i=f("div"),a&&a.c(),s=m(),l=f("ul"),l.textContent="+",y(l,"class","new-row svelte-j5ao4g"),y(i,"class","svelte-j5ao4g"),y(n,"class","container svelte-j5ao4g")},m(t,h){u(t,n,h),c(n,i),a&&a.m(i,null),c(i,s),c(i,l),r||(o=w(l,"click",e[4]),r=!0)},p(t,[e]){t[1].name?a?a.p(t,e):(a=Ft(t),a.c(),a.m(i,s)):a&&(a.d(1),a=null)},i:t,o:t,d(t){t&&h(n),a&&a.d(),r=!1,o()}}}function Zt(){this.select()}function Jt(t,e,n){let i,s,l,o,c;function u(t){n(0,d=d.sort(((e,n)=>e[t]-n[t])))}function h(t){n(0,d=d.sort(((e,n)=>n[t]-e[t])))}r(t,kt,(t=>n(1,i=t))),r(t,$t,(t=>n(17,s=t))),r(t,bt,(t=>n(18,l=t))),r(t,_t,(t=>n(19,o=t))),r(t,qt,(t=>n(2,c=t)));let d;return t.$$.update=()=>{2&t.$$.dirty&&n(0,d=i.contents.slice(5))},[d,i,c,function(){let t=J(i.contents,5,s.units,s.cutter,s.gap,s.material);a(bt,l=t[0]),a(_t,o=t[1]),a(kt,i.errors=t[2],i)},function(){let t=[d.length+1,,];a(kt,i.contents=[...i.contents,t],i)},u,h,()=>u(0),()=>h(1),()=>h(2),()=>h(3),function(t,e){t[e][0]=this.value,n(0,d),n(1,i)},function(t,e){t[e][1]=x(this.value),n(0,d),n(1,i)},function(t,e){t[e][2]=x(this.value),n(0,d),n(1,i)},function(t,e){t[e][3]=x(this.value),n(0,d),n(1,i)},t=>a(qt,c=t[0]),()=>a(qt,c="")]}class Kt extends B{constructor(t){super(),F(this,t,Jt,Xt,l,{})}}function Qt(t,e,n){const i=t.slice();return i[2]=e[n],i[4]=n,i}function Vt(t){let e,n=t[1].length>1&&te(t);return{c(){n&&n.c(),e=v()},m(t,i){n&&n.m(t,i),u(t,e,i)},p(t,i){t[1].length>1?n?n.p(t,i):(n=te(t),n.c(),n.m(e.parentNode,e)):n&&(n.d(1),n=null)},d(t){n&&n.d(t),t&&h(e)}}}function te(t){let e,n,i,s,l,r,o=parseInt(t[1].slice(0,-1).reduce(ie,0))+"";return{c(){e=f("p"),e.textContent="filled sheets",n=m(),i=f("p"),s=g("waste: "),l=g(o),r=g("%")},m(t,o){u(t,e,o),u(t,n,o),u(t,i,o),c(i,s),c(i,l),c(i,r)},p(t,e){2&e&&o!==(o=parseInt(t[1].slice(0,-1).reduce(ie,0))+"")&&$(l,o)},d(t){t&&h(e),t&&h(n),t&&h(i)}}}function ee(t){let e,n,i,s,l,r,o,a,d,p,v,w,x,b,_,k,z,q,j,S,E,H=t[2].id+"",R=it(t[2].area/144,2)+"",A=it(t[2].waste_area/144,2)+"",M=it(100*t[2].waste_ratio,2)+"";return{c(){e=f("div"),n=f("h4"),i=g(H),s=m(),l=f("p"),r=g("used area: "),o=g(R),a=g(" pi"),d=f("sup"),d.textContent="2",p=m(),v=f("p"),w=g("waste area: "),x=g(A),b=g(" pi"),_=f("sup"),_.textContent="2",k=m(),z=f("p"),q=g("waste: "),j=g(M),S=g("%"),E=m(),y(d,"class","svelte-18pxdu6"),y(_,"class","svelte-18pxdu6"),y(e,"class","svelte-18pxdu6")},m(t,h){u(t,e,h),c(e,n),c(n,i),c(e,s),c(e,l),c(l,r),c(l,o),c(l,a),c(l,d),c(e,p),c(e,v),c(v,w),c(v,x),c(v,b),c(v,_),c(e,k),c(e,z),c(z,q),c(z,j),c(z,S),c(e,E)},p(t,e){2&e&&H!==(H=t[2].id+"")&&$(i,H),2&e&&R!==(R=it(t[2].area/144,2)+"")&&$(o,R),2&e&&A!==(A=it(t[2].waste_area/144,2)+"")&&$(x,A),2&e&&M!==(M=it(100*t[2].waste_ratio,2)+"")&&$(j,M)},d(t){t&&h(e)}}}function ne(e){let n,i,s,l=e[0].name&&Vt(e),r=e[1],o=[];for(let t=0;t<r.length;t+=1)o[t]=ee(Qt(e,r,t));return{c(){n=f("div"),l&&l.c(),i=m();for(let t=0;t<o.length;t+=1)o[t].c();s=v(),y(n,"class","svelte-18pxdu6")},m(t,e){u(t,n,e),l&&l.m(n,null),u(t,i,e);for(let n=0;n<o.length;n+=1)o[n].m(t,e);u(t,s,e)},p(t,[e]){if(t[0].name?l?l.p(t,e):(l=Vt(t),l.c(),l.m(n,null)):l&&(l.d(1),l=null),2&e){let n;for(r=t[1],n=0;n<r.length;n+=1){const i=Qt(t,r,n);o[n]?o[n].p(i,e):(o[n]=ee(i),o[n].c(),o[n].m(s.parentNode,s))}for(;n<o.length;n+=1)o[n].d(1);o.length=r.length}},i:t,o:t,d(t){t&&h(n),l&&l.d(),t&&h(i),d(o,t),t&&h(s)}}}const ie=(t,e,n,i)=>t+100*e.waste_ratio/i.length;function se(t,e,n){let i,s;return r(t,kt,(t=>n(0,i=t))),r(t,_t,(t=>n(1,s=t))),[i,s]}class le extends B{constructor(t){super(),F(this,t,se,ne,l,{})}}function re(e){let n,i,s,l,r,o,a,d,p,g,v,w;return s=new Ct({}),o=new Kt({}),d=new Pt({}),v=new le({}),{c(){n=f("div"),i=f("div"),T(s.$$.fragment),l=m(),r=f("div"),T(o.$$.fragment),a=m(),T(d.$$.fragment),p=m(),g=f("div"),T(v.$$.fragment),y(i,"class","import svelte-99m0r7"),y(r,"class","main svelte-99m0r7"),y(g,"class","info svelte-99m0r7"),y(n,"class","container svelte-99m0r7")},m(t,e){u(t,n,e),c(n,i),P(s,i,null),c(n,l),c(n,r),P(o,r,null),c(r,a),P(d,r,null),c(n,p),c(n,g),P(v,g,null),w=!0},p:t,i(t){w||(N(s.$$.fragment,t),N(o.$$.fragment,t),N(d.$$.fragment,t),N(v.$$.fragment,t),w=!0)},o(t){O(s.$$.fragment,t),O(o.$$.fragment,t),O(d.$$.fragment,t),O(v.$$.fragment,t),w=!1},d(t){t&&h(n),L(s),L(o),L(d),L(v)}}}return new class extends B{constructor(t){super(),F(this,t,null,re,l,{})}}({target:document.body})}();
//# sourceMappingURL=bundle.js.map
